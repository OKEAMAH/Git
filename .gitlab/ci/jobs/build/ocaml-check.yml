ocaml-check:
  extends:
    - .default_settings_template
    - .image_template__runtime_build_dependencies
  stage: build
  needs: [trigger]
  rules:
    - changes:
        paths:
          - src/**/*
          - tezt/**/*
          - .gitlab/**/*
          - .gitlab-ci.yml
          - devtools/**/*
      when: on_success
  before_script:
    - ./scripts/ci/take_ownership.sh
    - . ./scripts/version.sh
    - eval $(opam env)
  script:
    - dune build @check
