build_kernels:
  extends:
    - .tags_template__build
    - .kernels_template
    - .tags_template__gcp
  stage: build
  needs: [trigger]
  script:
    - make -f kernels.mk build
  artifacts:
    name: "build-kernels-$CI_COMMIT_REF_SLUG"
    paths:
      - evm_kernel.wasm
      - smart-rollup-installer
      - sequenced_kernel.wasm
      - tx_kernel.wasm
      - tx_kernel_dal.wasm
      - dal_echo_kernel.wasm
      - risc-v-sandbox
      - risc-v-dummy.elf
    expire_in: 1 day
    when: on_success
