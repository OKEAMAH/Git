# This file was automatically generated, do not edit.
# Edit file ci/bin/main.ml instead.

test_kernels:
  image: ${build_deps_image_name}:rust-toolchain--${build_deps_image_version}
  stage: test
  tags:
  - gcp
  rules:
  - changes:
    - .gitlab-ci.yml
    - kernels.mk
    - src/kernel_*/**/*
    - src/risc_v/**/*
    - etherlink/kernel_evm/**/*
    - .gitlab/**/*
    - .gitlab-ci.yml
    when: on_success
  needs:
  - trigger
  dependencies: []
  cache:
    key: kernels
    paths:
    - cargo/
  script:
  - make -f kernels.mk check
  - make -f kernels.mk test
  variables:
    CC: clang
    CARGO_HOME: $CI_PROJECT_DIR/cargo
    NATIVE_TARGET: x86_64-unknown-linux-musl
